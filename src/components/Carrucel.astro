---
import ImageCarrucel from "./ImageCarrucel.astro";
import ambientes from "@/assets/banners/ambientes.webp";
import equipos from "@/assets/banners/equipos.webp";
import estudios from "@/assets/banners/estudios.webp";
import pediatricos from "@/assets/banners/pediatricos.webp";
import ClockIcon from "./ClockIcon.astro";
import computer from "@/assets/icons/computer.png";
import { Image } from "astro:assets";
// No necesitas importar nada
const data = {
  ambientes: {
    src: ambientes,
    alt: "Ambientes acondicionados",
  },
  equipos: {
    src: equipos,
    alt: "Equipos de ultima generación",
  },
  estudios: {
    src: estudios,
    alt: "Estudios las 24 horas del día",
  },
  pediatricos: {
    src: pediatricos,
    alt: "Estudios pedriátricos (niños recién nacidos)",
  },
};
---

<div id="default-carousel" class="relative w-full" data-carousel="slide">
  <!-- Carousel wrapper -->
  <div class="relative h-56 overflow-hidden rounded-lg md:h-96">
    <!-- Items -->
    <div
      class="carousel-item hidden duration-700 ease-in-out"
      data-carousel-item
    >
      <ImageCarrucel
        Arte={ambientes}
        title="Ambientes acondicionados"
        titlePosition="right"
      >
        <div class="text-center text-white">
          <svg
            xmlns="http://www.w3.org/2000/svg"
            width="50"
            height="50"
            fill="currentColor"
            class="bi bi-house-heart"
            viewBox="0 0 16 16"
          >
            <path
              d="M8 6.982C9.664 5.309 13.825 8.236 8 12 2.175 8.236 6.336 5.309 8 6.982"
            ></path>
            <path
              d="M8.707 1.5a1 1 0 0 0-1.414 0L.646 8.146a.5.5 0 0 0 .708.707L2 8.207V13.5A1.5 1.5 0 0 0 3.5 15h9a1.5 1.5 0 0 0 1.5-1.5V8.207l.646.646a.5.5 0 0 0 .708-.707L13 5.793V2.5a.5.5 0 0 0-.5-.5h-1a.5.5 0 0 0-.5.5v1.293zM13 7.207V13.5a.5.5 0 0 1-.5.5h-9a.5.5 0 0 1-.5-.5V7.207l5-5z"
            ></path>
          </svg>
        </div>
      </ImageCarrucel>
    </div>
    <div
      class="carousel-item hidden duration-700 ease-in-out"
      data-carousel-item
    >
      <ImageCarrucel
        Arte={equipos}
        title="Equipos de ultima generación"
        titlePosition="left"
      >
        <Image src={computer} width={100} alt={computer.src} />
      </ImageCarrucel>
    </div>
    <div
      class="carousel-item hidden duration-700 ease-in-out"
      data-carousel-item
    >
      <ImageCarrucel Arte={estudios} title="Estudios las 24 horas del día">
        <ClockIcon color="white" Width={"50"} Height={"50"} />
      </ImageCarrucel>
    </div>
    <div
      class="carousel-item hidden duration-700 ease-in-out"
      data-carousel-item
    >
      <ImageCarrucel
        Arte={pediatricos}
        title="Estudios pedriátricos (niños recién nacidos)"
      />
    </div>
  </div>

  <!-- Indicators -->
  <div class="absolute z-30 flex -translate-x-1/2 bottom-5 left-1/2 space-x-3">
    <button
      class="carousel-indicator w-3 h-3 rounded-full bg-black/50"
      data-slide="0"></button>
    <button
      class="carousel-indicator w-3 h-3 rounded-full bg-black/50"
      data-slide="1"></button>
    <button
      class="carousel-indicator w-3 h-3 rounded-full bg-black/50"
      data-slide="2"></button>
    <button
      class="carousel-indicator w-3 h-3 rounded-full bg-black/50"
      data-slide="3"></button>
  </div>

  <!-- Controls -->
  <button
    class="absolute top-0 start-0 z-30 flex items-center justify-center h-full px-4 cursor-pointer group focus:outline-none"
    id="prev-btn"
  >
    <span
      class="inline-flex items-center justify-center w-10 h-10 rounded-full bg-white/30 dark:bg-gray-800/30 group-hover:bg-white/50 dark:group-hover:bg-gray-800/60 group-focus:ring-4 group-focus:ring-white dark:group-focus:ring-gray-800/70 group-focus:outline-none"
    >
      <svg
        class="w-4 h-4 text-white dark:text-gray-800 rtl:rotate-180"
        aria-hidden="true"
        xmlns="http://www.w3.org/2000/svg"
        fill="none"
        viewBox="0 0 6 10"
      >
        <path
          stroke="currentColor"
          stroke-linecap="round"
          stroke-linejoin="round"
          stroke-width="2"
          d="M5 1 1 5l4 4"></path>
      </svg>
      <span class="sr-only">Previous</span>
    </span>
  </button>
  <button
    class="absolute top-0 end-0 z-30 flex items-center justify-center h-full px-4 cursor-pointer group focus:outline-none"
    id="next-btn"
  >
    <span
      class="inline-flex items-center justify-center w-10 h-10 rounded-full bg-white/30 dark:bg-gray-800/30 group-hover:bg-white/50 dark:group-hover:bg-gray-800/60 group-focus:ring-4 group-focus:ring-white dark:group-focus:ring-gray-800/70 group-focus:outline-none"
    >
      <svg
        class="w-4 h-4 text-white dark:text-gray-800 rtl:rotate-180"
        aria-hidden="true"
        xmlns="http://www.w3.org/2000/svg"
        fill="none"
        viewBox="0 0 6 10"
      >
        <path
          stroke="currentColor"
          stroke-linecap="round"
          stroke-linejoin="round"
          stroke-width="2"
          d="m1 9 4-4-4-4"></path>
      </svg>
      <span class="sr-only">Next</span>
    </span>
  </button>
</div>

<script>
  const items = document.querySelectorAll<HTMLDivElement>(
    "[data-carousel-item]"
  );
  const indicators = document.querySelectorAll<HTMLButtonElement>(
    ".carousel-indicator"
  );
  const prevBtn = document.getElementById("prev-btn");
  const nextBtn = document.getElementById("next-btn");
  let current = 0;

  function showSlide(index: number) {
    items.forEach((el, i) => {
      el.classList.toggle("hidden", i !== index);
      indicators[i].classList.toggle("bg-black", i === index);
      indicators[i].classList.toggle("bg-blacks/50", i !== index);
    });
    current = index;
  }

  prevBtn?.addEventListener("click", () => {
    const newIndex = (current - 1 + items.length) % items.length;
    showSlide(newIndex);
  });

  nextBtn?.addEventListener("click", () => {
    const newIndex = (current + 1) % items.length;
    showSlide(newIndex);
  });

  indicators.forEach((btn, i) => {
    btn.addEventListener("click", () => showSlide(i));
  });

  // Mostrar el primer slide al cargar
  showSlide(0);
</script>

<style>
  .carousel-img {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    width: 100%;
  }
</style>
